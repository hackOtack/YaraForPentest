rule libxerces_SAXParser{
	meta:
         	my_identifier_1 = "Detects php code vulnerable to xxe"
		reference = "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#php"

	strings:
		//DOMDocument followed by load
		$s4_1 = "DOMDocument"	
		$s4_2 = "load("
		$s4_3 = "loadXML("

		$disable_xxe = "libxml_disable_entity_loader(true)"
		$enable_xxe = " libxml_disable_entity_loader(false)"

	condition:
		$enable_xxe or 
		$s4_1 and ($s4_2 or $s4_3) and not $disable_xxe
}
