rule xxe_python{
	meta:
         	my_identifier_1 = "Detects python code vulnerable to xxe"
		reference = "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#python"

	strings:
		//lxml module
		$s1_1 = /XMLParser\(.*resolve_entities=True/
		$s1_2 = "XMLParser()"
		
		//xml.sax module
		$s2 = "xml.sax"
		$s2_1 = "setFeature(feature_external_ges, True)"
		$s2_2 = "parse("

	condition:
		(any of ($s1_*))
		or 
		(all of ($s2*))

}
