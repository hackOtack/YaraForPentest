rule libxml2{
	meta:
         	my_identifier_1 = "Detects vulnerable libxml2 apis"
		reference = "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#cc"

	strings:
		//vulnerable APIs
		$api1 = "xmlCtxtReadDoc"
		$api2 = "xmlCtxtReadFd"
		$api3 = "xmlCtxtReadFile"
		$api4 = "xmlCtxtReadIO"
		$api5 =	"xmlCtxtReadMemory"
		$api6 =	"xmlCtxtUseOptions"
		$api7 =	"xmlParseInNodeContext"
		$api8 =	"xmlReadDoc"
		$api9 =	"xmlReadFd"
		$api10 = "xmlReadFile"
		$api11 = "xmlReadIO"
		$api12 = "xmlReadMemory"

		//bad parameters
		$param1 = "XML_PARSE_NOENT"
		$param2 = "XML_PARSE_DTDLOAD"

	condition:
		any of ($api*) and 1 of ($param*)
}
